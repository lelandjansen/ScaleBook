/*
  ScaleBook
  ScaleBookAngular.min.js
  v1.0.0
  Copyright (c) Leland Jansen 2015. All rights reserved.
*/

var searchApp=angular.module("searchApp",["filters","ngRoute","ngCookies"]);searchApp.controller("searchController",["$scope","$location","$cookies",function(e,a,t){e.searchField=t.get("userInputCookie"),e.$watch(function(e){e.hashValue=location.hash}),e.submit=function(e){t.put("userInputCookie",e);var a=parseUserInput(e),n=a[2],r=a[3],l=a[4];switch(n){case"answer":window.location.href="/#/answer",document.getElementById("searchField").focus();break;case"scale":window.location.href="/scale?/"+r+"/#/"+l.replace(/\s+/g,""),document.getElementById("searchField").focus();break;case"error":window.location.href="https://github.com/lelandjansen/ScaleBook/issues",document.getElementById("searchField").focus();break;case"cpanel":window.open("http://cpanel.scalebook.org","_blank");break;case"github":window.open("https://github.com/lelandjansen/ScaleBook","_blank")}},e.main=function(){"#/answer"===location.hash&&(window.location.href="/#/",document.getElementById("searchField").focus())},e.reset=function(){t.put("userInputCookie",""),window.location.href="/#/",e.searchField="",document.getElementById("searchField").focus(),e.searchForm.$setPristine()}}]),angular.module("filters",["ngSanitize"]).filter("interpreter",function(){return function(e){return parseUserInput(e)[0]}}).filter("answer",function(){return function(e){return parseUserInput(e)[1]}}).filter("textStyle",function(){return function(e){return e.replace(/-/g," ").replace(/ sharps or flats/g,"<span class='musicText'>#</span>/<span class='musicText'>b</span>").replace(/ flats or sharps/g,"<span class='musicText'>b</span>/<span class='musicText'>#</span>").replace(/ sharps/g,"<span class='musicText'>#</span>").replace(/ sharp/g,"<span class='musicText'>#</span>").replace(/ flats/g,"<span class='musicText'>b</span>").replace(/ flat/g,"<span class='musicText'>b</span>")}}).filter("capitalizeFirstLetter",function(){return function(e){return e.charAt(0).toUpperCase()+e.slice(1)}}).filter("trustAsHTML",["$sce",function(e){return function(a){return e.trustAsHtml(a)}}]),searchApp.config(function(e){e.when("/",{templateUrl:"partials/main.html"}).when("/answer",{templateUrl:"partials/answer.html"}).when("/400",{templateUrl:"partials/error/400.html"}).when("/401",{templateUrl:"partials/error/401.html"}).when("/403",{templateUrl:"partials/error/403.html"}).when("/404",{templateUrl:"partials/error/404.html"}).when("/405",{templateUrl:"partials/error/405.html"}).when("/500",{templateUrl:"partials/error/500.html"}).otherwise({redirectTo:"/404"})});var scaleApp=angular.module("scaleApp",["filters","ngRoute","ngCookies"]);scaleApp.config(function(e){e.when("/major",{templateUrl:"partials/scale/major.html"}).when("/minor",{templateUrl:"partials/scale/minor.html"}).when("/ionian",{templateUrl:"partials/scale/ionian.html"}).when("/dorian",{templateUrl:"partials/scale/dorian.html"}).when("/phrygian",{templateUrl:"partials/scale/phrygian.html"}).when("/lydian",{templateUrl:"partials/scale/lydian.html"}).when("/mixolydian",{templateUrl:"partials/scale/mixolydian.html"}).when("/aeolian",{templateUrl:"partials/scale/aeolian.html"}).when("/locrian",{templateUrl:"partials/scale/locrian.html"}).when("/blues",{templateUrl:"partials/scale/blues.html"}).when("/chromatic",{templateUrl:"partials/scale/chromatic.html"}).when("/pentatonic",{redirectTo:"/major"}).when("/wholetone",{templateUrl:"partials/scale/wholetone.html"}).otherwise({redirectTo:"/404"})}),scaleApp.run(["$location","$rootScope",function(e,a){a.$on("$routeChangeSuccess",function(e,t){t.$$route&&t.$$route.title&&(a.title=t.$$route.title)})}]),scaleApp.controller("scaleController",["$scope","$cookies",function(e,a){e.miniSearchField=a.get("userInputCookie"),e.submit=function(e){a.put("userInputCookie",e);var t=parseUserInput(e),n=t[2],r=t[3],l=t[4];switch(n){case"answer":window.location.href="/#/answer",document.getElementById("miniSearchField").focus();break;case"scale":window.location.href="/scale?/"+r+"/#/"+l.replace(/\s+/g,""),document.getElementById("miniSearchField").focus();break;case"error":window.location.href="https://github.com/lelandjansen/ScaleBook/issues",document.getElementById("miniSearchField").focus();break;case"cpanel":window.open("http://cpanel.scalebook.org","_blank");break;case"github":window.open("https://github.com/lelandjansen/ScaleBook","_blank")}},e.main=function(){"#/answer"===location.hash&&(window.location.href="/#/",document.getElementById("miniSearchField").focus())},e.reset=function(){a.put("userInputCookie",""),dow.location.href="/#/",e.miniSearchField="",document.getElementById("miniSearchField").focus(),e.searchForm.$setPristine()},e.$watch(function(e){e.noteName=location.search.replace(/\?/g,"").replace(/\//g,""),e.scale=location.hash.replace(/\#/g,"").replace(/\//g,""),"wholetone"===e.scale&&(e.scale="whole tone");var a;switch(e.scale){case"major":a=[2,2,1,2,2,2,1];break;case"minor":a=[2,1,2,2,1,2,2];break;case"ionian":a=[2,2,1,2,2,2,1];break;case"dorian":a=[2,1,2,2,2,1,2];break;case"phrygian":a=[1,2,2,2,1,2,2];break;case"lydian":a=[2,2,2,1,2,2,1];break;case"mixolydian":a=[2,2,1,2,2,1,2];break;case"aeolian":a=[2,1,2,2,1,2,2];break;case"locrian":a=[1,2,2,2,1,2,2];break;case"blues":a=[3,2,1,1,3,2];break;case"chromatic":a=[1,1,1,1,1,1,1,1,1,1,1,1];break;case"whole tone":a=[2,2,2,2,2,2]}e.scaleArray=generateScale(e.noteName,a);var t=whiteNoteNameToNumber(e.noteName.charAt(0).toUpperCase());e.noteName.indexOf("sharp")>-1?t+=1:e.noteName.indexOf("flat")>-1&&(t-=1),e.keySignature=determineKeySignatureName(determineKeySignature(t,e.scale.replace("blues","blue").replace("whole tone","whole")))+" "+listKeySignatureNotes(determineKeySignature(t,e.scale.replace("blues","blue").replace("whole tone","whole"))).replace("<br/>",""),e.enharmonicNoteName=determineEnharmonic(e.noteName,e.scale)})}]);
